module Day15.DetectorSpec (spec) where

import qualified Common.OctaGridPosition as Position
import Day15.ComprehensiveMap
import Day15.Detector
import Day15.SensorAndBeaconReport (readMany)
import Test.Hspec

exampleInput :: String
exampleInput = "Sensor at x=2, y=18: closest beacon is at x=-2, y=15\nSensor at x=9, y=16: closest beacon is at x=10, y=16\nSensor at x=13, y=2: closest beacon is at x=15, y=3\nSensor at x=12, y=14: closest beacon is at x=10, y=16\nSensor at x=10, y=20: closest beacon is at x=10, y=16\nSensor at x=14, y=17: closest beacon is at x=10, y=16\nSensor at x=8, y=7: closest beacon is at x=2, y=10\nSensor at x=2, y=0: closest beacon is at x=2, y=10\nSensor at x=0, y=11: closest beacon is at x=2, y=10\nSensor at x=20, y=14: closest beacon is at x=25, y=17\nSensor at x=17, y=20: closest beacon is at x=21, y=22\nSensor at x=16, y=7: closest beacon is at x=15, y=3\nSensor at x=14, y=3: closest beacon is at x=15, y=3\nSensor at x=20, y=1: closest beacon is at x=15, y=3"

spec :: Spec
spec = do
  describe "When create from map" $ do
    let detector = from . fromReports . readMany $ exampleInput

    describe "When scan beacon-free area for Sensor at x=8, y=7" $ do
      it "Should detect empty area for (8, 7)" $ do
        (noBeacons . scanFor (Position.from 8 7) $ detector)
          `shouldBe` [ Position.from (-1) 7,
                       Position.from 0 6,
                       Position.from 0 7,
                       Position.from 0 8,
                       Position.from 1 5,
                       Position.from 1 6,
                       Position.from 1 7,
                       Position.from 1 8,
                       Position.from 1 9,
                       Position.from 2 4,
                       Position.from 2 5,
                       Position.from 2 6,
                       Position.from 2 7,
                       Position.from 2 8,
                       Position.from 2 9,
                       Position.from 3 3,
                       Position.from 3 4,
                       Position.from 3 5,
                       Position.from 3 6,
                       Position.from 3 7,
                       Position.from 3 8,
                       Position.from 3 9,
                       Position.from 3 10,
                       Position.from 3 11,
                       Position.from 4 2,
                       Position.from 4 3,
                       Position.from 4 4,
                       Position.from 4 5,
                       Position.from 4 6,
                       Position.from 4 7,
                       Position.from 4 8,
                       Position.from 4 9,
                       Position.from 4 10,
                       Position.from 4 11,
                       Position.from 4 12,
                       Position.from 5 1,
                       Position.from 5 2,
                       Position.from 5 3,
                       Position.from 5 4,
                       Position.from 5 5,
                       Position.from 5 6,
                       Position.from 5 7,
                       Position.from 5 8,
                       Position.from 5 9,
                       Position.from 5 10,
                       Position.from 5 11,
                       Position.from 5 12,
                       Position.from 5 13,
                       Position.from 6 0,
                       Position.from 6 1,
                       Position.from 6 2,
                       Position.from 6 3,
                       Position.from 6 4,
                       Position.from 6 5,
                       Position.from 6 6,
                       Position.from 6 7,
                       Position.from 6 8,
                       Position.from 6 9,
                       Position.from 6 10,
                       Position.from 6 11,
                       Position.from 6 12,
                       Position.from 6 13,
                       Position.from 6 14,
                       Position.from 7 (-1),
                       Position.from 7 0,
                       Position.from 7 1,
                       Position.from 7 2,
                       Position.from 7 3,
                       Position.from 7 4,
                       Position.from 7 5,
                       Position.from 7 6,
                       Position.from 7 7,
                       Position.from 7 8,
                       Position.from 7 9,
                       Position.from 7 10,
                       Position.from 7 11,
                       Position.from 7 12,
                       Position.from 7 13,
                       Position.from 7 14,
                       Position.from 7 15,
                       Position.from 8 (-2),
                       Position.from 8 (-1),
                       Position.from 8 0,
                       Position.from 8 1,
                       Position.from 8 2,
                       Position.from 8 3,
                       Position.from 8 4,
                       Position.from 8 5,
                       Position.from 8 6,
                       Position.from 8 8,
                       Position.from 8 9,
                       Position.from 8 10,
                       Position.from 8 11,
                       Position.from 8 12,
                       Position.from 8 13,
                       Position.from 8 14,
                       Position.from 8 15,
                       Position.from 8 16,
                       Position.from 9 (-1),
                       Position.from 9 0,
                       Position.from 9 1,
                       Position.from 9 2,
                       Position.from 9 3,
                       Position.from 9 4,
                       Position.from 9 5,
                       Position.from 9 6,
                       Position.from 9 7,
                       Position.from 9 8,
                       Position.from 9 9,
                       Position.from 9 10,
                       Position.from 9 11,
                       Position.from 9 12,
                       Position.from 9 13,
                       Position.from 9 14,
                       Position.from 9 15,
                       Position.from 10 0,
                       Position.from 10 1,
                       Position.from 10 2,
                       Position.from 10 3,
                       Position.from 10 4,
                       Position.from 10 5,
                       Position.from 10 6,
                       Position.from 10 7,
                       Position.from 10 8,
                       Position.from 10 9,
                       Position.from 10 10,
                       Position.from 10 11,
                       Position.from 10 12,
                       Position.from 10 13,
                       Position.from 10 14,
                       Position.from 11 1,
                       Position.from 11 2,
                       Position.from 11 3,
                       Position.from 11 4,
                       Position.from 11 5,
                       Position.from 11 6,
                       Position.from 11 7,
                       Position.from 11 8,
                       Position.from 11 9,
                       Position.from 11 10,
                       Position.from 11 11,
                       Position.from 11 12,
                       Position.from 11 13,
                       Position.from 12 2,
                       Position.from 12 3,
                       Position.from 12 4,
                       Position.from 12 5,
                       Position.from 12 6,
                       Position.from 12 7,
                       Position.from 12 8,
                       Position.from 12 9,
                       Position.from 12 10,
                       Position.from 12 11,
                       Position.from 12 12,
                       Position.from 13 3,
                       Position.from 13 4,
                       Position.from 13 5,
                       Position.from 13 6,
                       Position.from 13 7,
                       Position.from 13 8,
                       Position.from 13 9,
                       Position.from 13 10,
                       Position.from 13 11,
                       Position.from 14 4,
                       Position.from 14 5,
                       Position.from 14 6,
                       Position.from 14 7,
                       Position.from 14 8,
                       Position.from 14 9,
                       Position.from 14 10,
                       Position.from 15 5,
                       Position.from 15 6,
                       Position.from 15 7,
                       Position.from 15 8,
                       Position.from 15 9,
                       Position.from 16 6,
                       Position.from 16 8,
                       Position.from 17 7
                     ]
